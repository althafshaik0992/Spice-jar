<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Choose Payment • The Spice Jar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <style>
        body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:#f6fbf6;margin:0;color:#111}
        .wrap{max-width:1000px;margin:26px auto;padding:0 6%}
        .grid{display:grid;grid-template-columns:2fr 1fr;gap:18px}
        @media (max-width: 900px){ .grid{grid-template-columns:1fr} }
        .card{background:#fff;border:1px solid #e6ece7;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.06);padding:18px}
        .option{display:flex;align-items:center;justify-content:space-between;border:1px solid #e6ece7;border-radius:12px;padding:14px;margin-bottom:12px}
        .btn{display:inline-flex;align-items:center;gap:8px;border:none;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer;text-decoration:none}
        .btn-primary{background:#218838;color:#fff}
        .btn-outline{background:#fff;border:1px solid #e5e7eb;color:#111}
    </style>
</head>
<body>
<main class="wrap">
    <h1>Choose your payment method</h1>

    <section class="grid">
        <!-- LEFT: payment methods -->
        <div>
            <div class="card">
                <!-- Stripe (Checkout Session) -->
                <div class="option">
                    <div>
                        <div style="font-weight:800"><i class="fa-solid fa-credit-card"></i> Credit / Debit Card</div>
                        <div style="color:#6b7a70;font-size:14px">Secure card payment via Stripe Checkout.</div>
                    </div>
                    <a class="btn btn-primary"
                       th:href="@{/payment/stripe/start(orderId=${order.id})}">
                        Pay with card
                    </a>
                </div>

                <!-- PayPal (server redirect) -->
                <div class="option">
                    <div>
                        <div style="font-weight:800"><i class="fa-brands fa-paypal"></i> PayPal</div>
                        <div style="color:#6b7a70;font-size:14px">You’ll be redirected to PayPal to approve the payment.</div>
                    </div>
                    <a class="btn btn-primary"
                       th:href="@{/payment/paypal/start(orderId=${order.id})}">
                        Continue with PayPal
                    </a>
                </div>

                <!-- COD -->
                <div class="option">
                    <div>
                        <div style="font-weight:800"><i class="fa-solid fa-truck"></i> Cash on Delivery</div>
                        <div style="color:#6b7a70;font-size:14px">Pay cash when your order arrives.</div>
                    </div>
                    <form th:action="@{/payment/cod}" method="post" style="margin:0">
                        <input type="hidden" name="orderId" th:value="${order.id}">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button class="btn btn-outline" type="submit">Choose COD</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- RIGHT: address + totals -->
        <aside class="card">
            <h3>Shipping address</h3>
            <div><b>Name</b> <span th:text="${order.customerName}">—</span></div>
            <div><b>Street</b> <span th:text="${order.street}">—</span></div>
            <div><b>City</b> <span th:text="${order.city}">—</span></div>
            <div><b>State</b> <span th:text="${order.state}">—</span></div>
            <div><b>ZIP</b> <span th:text="${order.zip}">—</span></div>
            <div><b>Country</b> <span th:text="${order.country}">—</span></div>
            <hr/>
            <div><b>Subtotal</b> <span th:text="${#numbers.formatDecimal(order.subtotal,1,'COMMA',2,'POINT')}">$0.00</span></div>
            <div><b>Tax (8%)</b> <span th:text="${#numbers.formatDecimal(order.tax,1,'COMMA',2,'POINT')}">$0.00</span></div>
            <div style="font-weight:900"><b>Total</b> <span th:text="${#numbers.formatDecimal(order.grandTotal,1,'COMMA',2,'POINT')}">$0.00</span></div>
        </aside>
    </section>
</main>
</body>
</html>
