<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Spice Jar - Register</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root { --green:#218838; --accent:#b7410e; --dark:#111; }
    *{box-sizing:border-box}
    body{
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; margin:0;
      background:#f0f8f0; color:#222; display:flex; flex-direction:column; align-items:center; min-height:100vh;
    }
    /* Navbar */
    .navbar{
      background:#fff; padding:6px 6%;
      box-shadow:0 2px 6px rgba(0,0,0,.05);
      display:flex; justify-content:space-between; align-items:center;
      position:sticky; top:0; z-index:1000; height:60px;
    }
    .brand-logo{display:flex; align-items:center; gap:8px; text-decoration:none; color:var(--green); font-weight:700; font-size:20px}
    .brand-logo video{width:36px; height:auto; border-radius:4px}
    .nav-links{display:flex; align-items:center; gap:18px}
    .nav-links a{text-decoration:none; color:#333; font-weight:500; font-size:15px}
    .nav-links a:hover{color:#218838}

    /* Dropdowns */
    .dropdown{position:relative}
    .dropdown-toggle{
      background:none; border:none; cursor:pointer; font-size:15px; color:#333;
      display:flex; align-items:center; gap:6px
    }
    .dropdown-menu{
      display:none; position:absolute; right:0; top:100%;
      background:#fff; box-shadow:0 4px 10px rgba(0,0,0,.1);
      border-radius:6px; overflow:hidden; min-width:180px
    }
    .dropdown:hover .dropdown-menu{display:block}
    .dropdown-menu a, .dropdown-menu span{
      display:block; padding:10px 16px; text-decoration:none; color:#333; white-space:nowrap
    }
    .dropdown-menu a:hover{background:#f4f4f4}
    .navbar{background:#fff;padding:6px 6%;box-shadow:0 2px 6px rgba(0,0,0,.05);
      display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;height:60px;width:100%}
    .brand-logo{display:flex;align-items:center;gap:8px;text-decoration:none;color:var(--green);font-weight:700;font-size:20px}
    .brand-logo video{width:36px;height:auto;border-radius:4px}
    .nav-links{display:flex;align-items:center;gap:18px}
    .nav-links a{text-decoration:none;color:#333;font-weight:500;font-size:15px}
    .nav-links a:hover{color:var(--green)}
    .auth-box{
      background:#fff;padding:30px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.1);
      text-align:center;width:100%;max-width:600px;margin-top:50px;
    }
    h2{color:var(--green);font-size:2em;margin-bottom:20px}
    form{display:flex;flex-direction:column;gap:15px}
    label{text-align:left;font-weight:600}
    input[type="text"],input[type="password"],input[type="email"],input[type="tel"],select{
      padding:12px;border-radius:8px;border:1px solid #ddd;width:100%;font-size:16px;
      transition:border-color .3s, box-shadow .3s;background:#fff;
    }
    input:focus,select:focus{
      outline:none;border-color:var(--green);box-shadow:0 0 0 2px rgba(33,136,56,.2);
    }
    button{background:var(--green);color:#fff;padding:12px 24px;border-radius:30px;border:none;cursor:pointer;font-weight:700;font-size:16px}
    button:hover{background:var(--accent)}
    .error{color:#b00020;margin-top:10px}
    .form-group{display:flex;flex-direction:column;gap:8px}

    /* Phone control */
    .phone-group{display:flex;gap:10px;align-items:center}
    .country-select{min-width:260px}
    .dial-wrap{
      display:flex;align-items:center;gap:8px;
      background:#f9faf9;border:1px solid #ddd;border-radius:8px;padding:12px;
      min-width:88px;justify-content:center;font-weight:700;
    }
    .dial-code{white-space:nowrap}
    .phone-input{flex:1}
    .inline-help{font-size:12px;color:#64748b;margin-top:-6px}

    /* Small screens */
    @media (max-width: 520px){
      .phone-group{flex-direction:column;align-items:stretch}
      .country-select{width:100%}
      .dial-wrap{justify-content:flex-start}
    }
  </style>
</head>
<body>
<!-- Navbar -->
<!-- Navbar -->
<nav class="navbar">
  <a href="/" class="brand-logo">
    <video src="/images/Spice-Jar.mp4" autoplay muted loop playsinline></video>
    <span>SpiceJar</span>
  </a>

  <div class="nav-links">
    <a th:href="@{/menu}">Menu</a>
    <a th:href="@{/about}">About Us</a>
    <a class="nav-link" th:href="@{/cart/view}">
      <div class="cart-icon-container" aria-live="polite" aria-label="Cart items">
        <i class="fas fa-shopping-cart" style="font-size:24px"></i>
        <span class="cart-count-badge" id="lblCartCount" th:text="${cartCount}">0</span>
      </div>
    </a>
    <a th:href="@{/contact}">Contact Us</a>

    <!-- Categories -->
    <div class="dropdown">
      <button class="dropdown-toggle">
        <i class="fa-solid fa-list"></i> Categories
      </button>
      <div class="dropdown-menu">
        <a th:each="c : ${categories}"
           th:href="@{/category/{id}(id=${c.id})}"
           th:text="${c.name}">Category</a>
      </div>
    </div>

    <!-- Account -->
    <div class="dropdown">
      <button class="dropdown-toggle">
        <i class="fas fa-user"></i>  Account
      </button>
      <div class="dropdown-menu">
        <a th:if="${session.USER == null}" th:href="@{/login}">Login</a>
        <a th:if="${session.USER == null}" th:href="@{/register}">Register</a>
        <span th:if="${session.USER != null}">
                 Welcome, <span th:text="${session.USER.firstName}">user</span>
                </span>
        <a  th:if="${session.USER != null}" th:href="@{/account}">Your Account</a>
        <a th:if="${session.USER != null}" th:href="@{/logout}">Logout</a>
      </div>
    </div>
  </div>
</nav>



<div class="auth-box">


  <div th:if="${msg}" style="margin:10px 0;padding:10px;border-radius:8px;background:#ecfdf5;color:#065f46" th:text="${msg}"></div>
  <div th:if="${err}" style="margin:10px 0;padding:10px;border-radius:8px;background:#fef2f2;color:#991b1b" th:text="${err}"></div>
  <h2>Register</h2>

  <form th:action="@{/register}" method="post">
    <div class="form-group">
      <label for="firstName">First Name</label>
      <input type="text" id="firstName" name="firstName" required/>
    </div>
    <div class="form-group">
      <label for="lastName">Last Name</label>
      <input type="text" id="lastName" name="lastName" required/>
    </div>

    <div class="form-group">
      <label for="address">Address</label>
      <input type="text" id="address" name="address" required/>
    </div>

    <!-- Country dropdown with flags & dial codes -->
    <div class="form-group">
      <label for="countrySelect">Country</label>
      <select id="countrySelect" class="country-select" name="country" required>
        <!-- value = country name; data-code = dial code; emojis used for flags -->
        <option value="United States" data-code="+1">ðŸ‡ºðŸ‡¸ United States (+1)</option>
        <option value="Canada" data-code="+1">ðŸ‡¨ðŸ‡¦ Canada (+1)</option>
        <option value="United Kingdom" data-code="+44">ðŸ‡¬ðŸ‡§ United Kingdom (+44)</option>
        <option value="India" data-code="+91" selected>ðŸ‡®ðŸ‡³ India (+91)</option>
        <option value="Pakistan" data-code="+92">ðŸ‡µðŸ‡° Pakistan (+92)</option>
        <option value="United Arab Emirates" data-code="+971">ðŸ‡¦ðŸ‡ª United Arab Emirates (+971)</option>
        <option value="Australia" data-code="+61">ðŸ‡¦ðŸ‡º Australia (+61)</option>
        <option value="Germany" data-code="+49">ðŸ‡©ðŸ‡ª Germany (+49)</option>
        <option value="France" data-code="+33">ðŸ‡«ðŸ‡· France (+33)</option>
      </select>
      <!-- what we actually submit as dial code -->
      <input type="hidden" id="countryCode" name="countryCode" value="+91"/>
    </div>

    <div class="form-group">
      <label for="city">City</label>
      <input type="text" id="city" name="city" required/>
    </div>
    <div class="form-group">
      <label for="state">State</label>
      <input type="text" id="state" name="state" required/>
    </div>
    <div class="form-group">
      <label for="zip">ZIP</label>
      <input type="text" id="zip" name="zip" required/>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" required/>
    </div>

    <!-- Phone control: flag/dial code display + phone input -->
    <div class="form-group">
      <label for="phone">Phone</label>
      <div class="phone-group">
        <div class="dial-wrap">
          <span class="dial-code" id="dialCode">+91</span>
        </div>
        <input
                type="tel"
                id="phone"
                name="phone"
                class="phone-input"
                inputmode="tel"
                autocomplete="tel-national"
                placeholder="98765 43210"
                required
                pattern="[0-9\\s\\-()]{6,20}"
                title="Enter your phone number (digits, spaces, dashes, parentheses allowed)"/>
      </div>
      <div class="inline-help">Weâ€™ll prepend the country code on submit.</div>
    </div>

    <div class="form-group">
      <label for="username">Username</label>
      <input type="text" id="username" name="username" required />
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" id="password" name="password" required />
    </div>

    <button type="submit">Create account</button>
  </form>

  <p>Already have an account? <a th:href="@{/login}">Login</a></p>
  <p th:if="${error}" class="error" th:text="${error}"></p>
</div>

<script>
  // Keep the dial code UI and hidden input in sync with the selected country
  (function(){
    const select = document.getElementById('countrySelect');
    const dialSpan = document.getElementById('dialCode');
    const hidden = document.getElementById('countryCode');

    function updateDial(){
      const code = select.options[select.selectedIndex].dataset.code || '';
      dialSpan.textContent = code;
      hidden.value = code;
      // Optional: tweak placeholder based on common format per country
      const phone = document.getElementById('phone');
      switch(code){
        case '+1':  phone.placeholder = '555 123 4567'; break;
        case '+44': phone.placeholder = '07123 456789'; break;
        case '+91': phone.placeholder = '98765 43210'; break;
        case '+92': phone.placeholder = '0301 2345678'; break;
        case '+971':phone.placeholder = '050 123 4567'; break;
        case '+61': phone.placeholder = '0412 345 678'; break;
        case '+49': phone.placeholder = '0151 2345678'; break;
        case '+33': phone.placeholder = '06 12 34 56 78'; break;
        default:    phone.placeholder = 'Phone number';
      }
    }
    select.addEventListener('change', updateDial);
    updateDial(); // init on load
  })();
</script>

</body>
</html>
