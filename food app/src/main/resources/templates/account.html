<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Your Account • The Spice Jar</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23218838'/%3E%3Cpath fill='%23fff' d='M10 21c0-4.2 5-4.2 5-8 0-1.4-.8-2.6-2-3.5 3 .3 5 2.2 5 4.7 0 3.6-4 4.6-4 7.8h6v1.5H10V21z'/%3E%3C/svg%3E">

  <!-- Icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- Optional font for consistency -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --green:#218838;
      --accent:#b7410e;
      --bg:#f5faf6;
      --card:#ffffff;
      --muted:#6b7280;
      --ring:rgba(15,23,42,.08);
    }

    * { box-sizing:border-box; }

    body {
      margin:0;
      font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Arial;
      background:radial-gradient(circle at top left, #f1fdf3 0, #f5faf6 40%, #f9fafb 100%);
      color:#111827;
    }

    a { color:inherit; }

    /* Navbar */
    .navbar {
      background:rgba(255,255,255,0.96);
      backdrop-filter:blur(8px);
      padding:8px 6%;
      box-shadow:0 2px 8px rgba(15,23,42,.06);
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:sticky;
      top:0;
      z-index:1000;
      gap:14px;
    }

    .brand-logo {
      display:flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color:var(--green);
      font-weight:800;
      font-size:20px;
      letter-spacing:.02em;
    }

    .brand-logo video {
      width:36px;
      height:36px;
      border-radius:8px;
      object-fit:cover;
      box-shadow:0 4px 12px rgba(0,0,0,0.15);
    }

    .nav-links {
      display:flex;
      align-items:center;
      gap:18px;
      flex-wrap:wrap;
    }

    .nav-links a {
      text-decoration:none;
      color:#374151;
      font-weight:500;
      font-size:14px;
      position:relative;
      padding:4px 0;
    }

    .nav-links a::after {
      content:"";
      position:absolute;
      left:0;
      bottom:-3px;
      width:0;
      height:2px;
      background:var(--green);
      border-radius:999px;
      transition:width .18s ease;
    }

    .nav-links a:hover::after {
      width:100%;
    }

    /* Navbar search */
    .nav-search {
      flex:1;
      max-width:520px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .nav-search input {
      width:100%;
      padding:8px 12px;
      border:1px solid #d1d5db;
      border-radius:999px;
      background:#fff;
      font-size:14px;
      outline:none;
    }

    .nav-search input:focus {
      border-color:var(--green);
      box-shadow:0 0 0 2px rgba(34,197,94,0.2);
    }

    .nav-search button {
      border:none;
      border-radius:999px;
      padding:8px 11px;
      background:var(--green);
      color:#fff;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .nav-search button:hover {
      background:var(--accent);
    }

    /* Cart count badge */
    .cart-icon-container {
      position:relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }

    .cart-count-badge {
      position:absolute;
      top:-6px;
      right:-10px;
      background-color:#ffb347;
      color:white;
      border-radius:999px;
      padding:1px 7px;
      font-size:11px;
      font-weight:bold;
      display:flex;
      align-items:center;
      justify-content:center;
      min-width:20px;
      height:18px;
      text-align:center;
      line-height:1;
      box-shadow:0 0 0 2px #fff;
    }

    /* Dropdown */
    .dropdown {
      position:relative;
    }

    .dropdown-toggle {
      display:flex;
      align-items:center;
      gap:8px;
      background:transparent;
      border:0;
      cursor:pointer;
      font-weight:700;
      color:#111827;
      padding:6px 10px;
      border-radius:999px;
      transition:background .15s ease, box-shadow .15s ease;
    }

    .dropdown-toggle:hover {
      background:#f3f4f6;
      box-shadow:0 0 0 1px rgba(148,163,184,0.3);
    }

    .dropdown-menu {
      display:none;
      position:absolute;
      right:0;
      top:calc(100% + 8px);
      background:#fff;
      box-shadow:0 10px 28px rgba(15,23,42,.16);
      border-radius:12px;
      overflow:hidden;
      min-width:200px;
      border:1px solid #e5e7eb;
    }

    .dropdown:hover .dropdown-menu {
      display:block;
    }

    .dropdown-menu a,
    .dropdown-menu span {
      display:block;
      padding:10px 14px;
      text-decoration:none;
      color:#111827;
      white-space:nowrap;
      font-size:14px;
      font-weight:500;
    }

    .dropdown-menu a:hover {
      background:#f7faf7;
    }

    .divider {
      height:1px;
      background:#e5e7eb;
      margin:6px 0;
    }

    /* Layout */
    .wrap {
      max-width:1100px;
      margin:26px auto 32px;
      padding:0 6%;
    }

    .page-header {
      margin-bottom:18px;
    }

    .page-header h1 {
      font-size:26px;
      margin:0 0 4px;
    }

    .page-subtitle {
      margin:0;
      font-size:14px;
      color:var(--muted);
    }

    .grid {
      display:grid;
      grid-template-columns:repeat(3, minmax(260px,1fr));
      gap:16px;
    }

    @media (max-width:980px) {
      .grid { grid-template-columns:repeat(2,1fr); }
    }

    @media (max-width:640px) {
      .navbar {
        flex-wrap:wrap;
      }
      .nav-search {
        order:3;
        width:100%;
        max-width:none;
      }
      .grid { grid-template-columns:1fr; }
    }

    .card {
      background:var(--card);
      border-radius:14px;
      box-shadow:0 12px 30px var(--ring);
      padding:16px;
      display:flex;
      gap:14px;
      align-items:flex-start;
      border:1px solid rgba(209,213,219,0.8);
    }

    .card i,
    .card .icon {
      font-size:26px;
      color:var(--green);
      margin-top:2px;
      flex-shrink:0;
    }

    .card h3 {
      margin:0 0 4px;
      font-size:17px;
    }

    .card p {
      margin:0;
      color:#475569;
      font-size:14px;
    }

    .badge {
      display:inline-block;
      background:#eef6ff;
      border:1px solid #dbeafe;
      border-radius:999px;
      padding:2px 8px;
      font-size:12px;
      color:#0f172a;
      margin-left:6px;
      font-weight:600;
    }

    .card a {
      display:block;
      margin-top:8px;
      color:var(--green);
      font-weight:700;
      text-decoration:none;
      font-size:14px;
    }

    .card a:hover {
      text-decoration:underline;
    }

    /* Gift card sub-actions */
    .card-actions {
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-top:10px;
    }

    .muted {
      color:var(--muted);
      font-size:13px;
    }

    /* Footer */
    .site-footer {
      background:#111827;
      color:#9ca3af;
      padding:40px 6% 26px;
      margin-top:40px;
    }

    .footer-container {
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      gap:30px;
      margin-bottom:30px;
    }

    .footer-column {
      flex:1;
      min-width:220px;
    }

    .footer-column h3 {
      color:#f9fafb;
      margin-bottom:14px;
      font-weight:600;
      border-bottom:2px solid var(--green);
      padding-bottom:6px;
      display:inline-block;
      font-size:15px;
    }

    .footer-column p {
      line-height:1.6;
      font-size:14px;
    }

    .footer-column ul {
      list-style:none;
      padding:0;
      margin:0;
    }

    .footer-column ul li a {
      text-decoration:none;
      color:#9ca3af;
      display:block;
      padding:5px 0;
      font-size:14px;
      transition:color .2s ease, transform .1s ease;
    }

    .footer-column ul li a:hover {
      color:#e5e7eb;
      transform:translateX(2px);
    }

    .social-links a {
      color:#9ca3af;
      text-decoration:none;
      font-size:20px;
      margin-right:16px;
      transition:color .2s ease, transform .1s ease;
    }

    .social-links a:hover {
      color:var(--green);
      transform:translateY(-1px);
    }

    .footer-bottom {
      text-align:center;
      padding-top:18px;
      border-top:1px solid #1f2937;
      font-size:13px;
      color:#6b7280;
    }

    @media (max-width:768px) {
      .footer-container {
        flex-direction:column;
        text-align:left;
      }
      .footer-column {
        margin-bottom:12px;
      }
    }
  </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar">
  <a href="/" class="brand-logo">
    <video src="/images/Spice-Jar.mp4" autoplay muted loop playsinline></video>
    <span>SpiceJar</span>
  </a>

  <form class="nav-search" role="search" onsubmit="return false;">
    <input id="nav-q" type="search" placeholder="Search spices…" aria-label="Search" th:value="${q}">
    <button id="nav-search-btn" type="button" aria-label="Search">
      <i class="fa-solid fa-magnifying-glass"></i>
    </button>
  </form>

  <div class="nav-links">
    <a th:href="@{/menu}">Menu</a>
    <a th:href="@{/about}">About Us</a>

    <a class="nav-link" th:href="@{/cart/view}">
      <div class="cart-icon-container" aria-live="polite" aria-label="Cart items">
        <i class="fas fa-shopping-cart" style="font-size:20px"></i>
        <span class="cart-count-badge" id="lblCartCount" th:text="${cartCount}">0</span>
      </div>
    </a>

    <a th:href="@{/contact}">Contact Us</a>

    <!-- Account -->
    <div class="dropdown">
      <button class="dropdown-toggle" type="button">
        <i class="fas fa-user"></i>
        <span th:text="${session.USER != null ? session.USER.firstName : 'Account'}">Account</span>
      </button>
      <div class="dropdown-menu">
        <a th:if="${session.USER == null}" th:href="@{/login}">Login</a>
        <a th:if="${session.USER == null}" th:href="@{/register}">Register</a>

        <span th:if="${session.USER != null}">
          Welcome, <strong th:text="${session.USER.firstName}">User</strong>
        </span>
        <a th:if="${session.USER != null}" th:href="@{/account}">Your Account</a>
        <a th:if="${session.USER != null}" th:href="@{/orders}">My Orders</a>
        <div class="divider" th:if="${session.USER != null}"></div>
        <a th:if="${session.USER != null}" th:href="@{/logout}">
          <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
        </a>
      </div>
    </div>
  </div>
</nav>

<div class="wrap">
  <header class="page-header">
    <h1>Your Account</h1>
    <p class="page-subtitle"
       th:text="${session.USER != null} ? 'Manage your orders, addresses, gift cards and more in one place.' : 'Sign in to manage your orders, addresses, gift cards and more.'">
      Manage your account.
    </p>
  </header>

  <div class="grid">
    <!-- Orders -->
    <div class="card">
      <i class="fa-solid fa-box"></i>
      <div>
        <h3>Your Orders <span class="badge" th:text="${orderCount}">0</span></h3>
        <p>Track, return, cancel an order, download invoices or reorder items.</p>
        <a th:href="@{/orders}">Go to Your Orders</a>
      </div>
    </div>

    <!-- Profile / Security -->
    <div class="card">
      <i class="fa-solid fa-user-shield"></i>
      <div>
        <h3>Login &amp; security</h3>
        <p>Edit your name, phone, email and password.</p>
        <a th:href="@{/profile/view}">View profile</a>
        <a th:href="@{/profile}">Edit profile</a>
      </div>
    </div>

    <!-- Addresses -->
    <div class="card">
      <i class="fa-solid fa-location-dot"></i>
      <div>
        <h3>Your Addresses <span class="badge" th:text="${addressCount}">0</span></h3>
        <p>Edit, remove or set a default delivery address.</p>
        <a th:href="@{/addresses}">Manage addresses</a>
      </div>
    </div>

    <!-- Gift Cards -->
    <div class="card">
      <i class="fa-solid fa-gift"></i>
      <div style="flex:1">
        <h3>Gift Cards</h3>
        <p>Redeem a code or manage your gift card balance.</p>

        <!-- Optional redeem form (kept commented as in your version)
        <form th:action="@{/gift-cards/redeem}" method="post" class="redeem-row" th:if="${session.USER != null}">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
          <input type="text" name="code" placeholder="Enter gift card code (e.g., SJ-9K4T-AX7L)"
                 required minlength="8" maxlength="32" autocomplete="off"/>
          <button type="submit"><i class="fa-solid fa-check"></i> Redeem</button>
        </form>
        <div class="muted" th:if="${session.USER == null}">Login to redeem a gift card.</div>
        -->

        <div class="card-actions">
          <a th:href="@{/gift-cards}"><i class="fa-solid fa-wallet"></i> Manage gift cards</a>
          <a th:href="@{/gift-cards/buy}"><i class="fa-solid fa-cart-shopping"></i> Buy a gift card</a>
        </div>
      </div>
    </div>

    <!-- Returns & refunds quick-link -->
    <div class="card">
      <i class="fa-solid fa-arrow-rotate-left"></i>
      <div>
        <h3>Returns &amp; Refunds</h3>
        <p>Start a return and check your refund status.</p>
        <a th:href="@{/orders}">Start a return</a>
      </div>
    </div>

    <!-- Help / Support -->
    <div class="card">
      <i class="fa-regular fa-life-ring"></i>
      <div>
        <h3>Support</h3>
        <p>Troubleshoot issues or reach out to our team.</p>
        <a th:href="@{/contact}">Get help</a>
      </div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-column">
      <h3>About Spice Jar</h3>
      <p>Bringing the world's finest spices to your kitchen. Quality, aroma, and flavor guaranteed in every jar.</p>
    </div>
    <div class="footer-column">
      <h3>Quick Links</h3>
      <ul>
        <li><a th:href="@{/menu}">Menu</a></li>
        <li><a th:href="@{/about}">About Us</a></li>
        <li><a th:href="@{/contact}">Contact</a></li>
        <li><a href="#">FAQ</a></li>
      </ul>
    </div>
    <div class="footer-column">
      <h3>Connect With Us</h3>
      <div class="social-links">
        <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
        <a href="#" aria-label="Pinterest"><i class="fab fa-pinterest"></i></a>
      </div>
    </div>
  </div>
  <div class="footer-bottom"><p>&copy; 2025 The Spice Jar. All rights reserved.</p></div>
</footer>
</body>
</html>
