<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<link rel="icon" type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23218838'/%3E%3Cpath fill='%23fff' d='M10 21c0-4.2 5-4.2 5-8 0-1.4-.8-2.6-2-3.5 3 .3 5 2.2 5 4.7 0 3.6-4 4.6-4 7.8h6v1.5H10V21z'/%3E%3C/svg%3E">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<head>
  <meta charset="UTF-8"/>
  <title>Your Account • The Spice Jar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    :root{--green:#218838;--accent:#b7410e;--bg:#f6fbf6;--card:#fff;--muted:#6b7280}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;background:var(--bg);color:#111}
    .navbar{background:#fff;padding:10px 6%;box-shadow:0 2px 6px rgba(0,0,0,.06);display:flex;justify-content:space-between;align-items:center}
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--green);font-weight:800}
    .brand video{width:36px;border-radius:6px}
    .nav a{color:#333;text-decoration:none;margin-left:16px;font-weight:600}
    .nav a:hover{color:var(--green)}
    .wrap{max-width:1100px;margin:26px auto;padding:0 6%}
    h1{font-size:28px;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(260px,1fr));gap:16px}
    @media (max-width:980px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.06);padding:16px;display:flex;gap:14px;align-items:flex-start}
    .card i, .card .icon{font-size:28px;color:var(--green)}
    .card h3{margin:0 0 4px;font-size:18px}
    .card p{margin:0;color:#475569}
    .card a{display:block;margin-top:8px;color:var(--green);font-weight:700;text-decoration:none}
    .badge{display:inline-block;background:#eef6ff;border:1px solid #dbeafe;border-radius:999px;padding:2px 8px;font-size:12px;color:#0f172a;margin-left:6px}
    .footer{color:#777;text-align:center;margin:28px 0}
    /* Navbar */
    .navbar{
      background:#fff; padding:6px 6%;
      box-shadow:0 2px 6px rgba(0,0,0,.05);
      display:flex; justify-content:space-between; align-items:center;
      position:sticky; top:0; z-index:1000; height:60px;
    }
    .brand-logo{display:flex; align-items:center; gap:8px; text-decoration:none; color:var(--green); font-weight:700; font-size:20px}
    .brand-logo video{width:36px; height:auto; border-radius:4px}
    .nav-links{display:flex; align-items:center; gap:18px}
    .nav-links a{text-decoration:none; color:#333; font-weight:500; font-size:15px}
    .nav-links a:hover{color:var(--green)}

    /* Dropdowns */
    .dropdown{position:relative}
    .dropdown-toggle{
      background:none; border:none; cursor:pointer; font-size:15px; color:#333;
      display:flex; align-items:center; gap:6px
    }
    .dropdown-menu{
      display:none; position:absolute; right:0; top:100%;
      background:#fff; box-shadow:0 4px 10px rgba(0,0,0,.1);
      border-radius:6px; overflow:hidden; min-width:180px
    }
    .dropdown:hover .dropdown-menu{display:block}
    .dropdown-menu a, .dropdown-menu span{
      display:block; padding:10px 16px; text-decoration:none; color:#333; white-space:nowrap
    }
    .dropdown-menu a:hover{background:#f4f4f4}
    /* Cart count badge style */
    .cart-icon-container {
      position: relative;
      display: inline-block;
    }
    .cart-count-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: var(--accent);
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 12px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 20px;
      height: 20px;
      text-align: center;
    }

    /* NEW: compact navbar search */
    .nav-search{flex:1; max-width:520px; display:flex; align-items:center; gap:8px}
    .nav-search input{
      width:100%; padding:10px 12px; border:1px solid #ddd; border-radius:999px;
      background:#fff; font-size:14px; outline:none;
    }
    .nav-search button{
      border:none; border-radius:999px; padding:9px 12px; background:var(--green); color:#fff; cursor:pointer;
    }
    .nav-search button:hover{background:var(--accent);}

    .dropdown{position:relative}
    .dropdown-toggle{
      display:flex; align-items:center; gap:8px; background:transparent; border:0; cursor:pointer;
      font-weight:700; color:#2b2b2b; padding:8px 10px; border-radius:10px;
    }
    .dropdown-toggle:hover{background:#f5f7f5}
    .dropdown-menu{
      position:absolute; right:0; top:calc(100% + 8px); min-width:200px;
      background:#fff; border:1px solid #eef2ef; border-radius:12px; box-shadow:0 10px 28px var(--ring);
      display:none; overflow:hidden;
    }
    .dropdown:hover .dropdown-menu{display:block}
    .dropdown-menu a, .dropdown-menu span{
      display:block; padding:10px 14px; text-decoration:none; color:#2b2b2b; font-weight:600;
      white-space:nowrap
    }
    .dropdown-menu a:hover{background:#f7faf7}
    .divider{height:1px; background:#eef2ef; margin:6px 0}
    /* Footer */
    .site-footer{ background:#222; color:#ccc; padding:40px 6%; margin-top:40px; }
    .footer-container { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 30px; margin-bottom: 30px; }
    .footer-column { flex: 1; min-width: 220px; }
    .footer-column h3 { color: #fff; margin-bottom: 15px; font-weight: 600; border-bottom: 2px solid var(--green); padding-bottom: 8px; display: inline-block; }
    .footer-column p { line-height: 1.6; font-size: 14px; }
    .footer-column ul { list-style: none; padding: 0; margin: 0; }
    .footer-column ul li a { text-decoration: none; color: #ccc; display: block; padding: 5px 0; font-size: 14px; transition: color 0.3s; }
    .footer-column ul li a:hover { color: #fff; }
    .social-links a { color: #ccc; text-decoration: none; font-size: 20px; margin-right: 15px; transition: color 0.3s; }
    .social-links a:hover { color: var(--green); }
    .footer-bottom { text-align: center; padding-top: 20px; border-top: 1px solid #444; font-size: 14px; }
    @media (max-width: 768px) { .footer-container { flex-direction: column; text-align: center; } .footer-column { margin-bottom: 20px; } }

    /* Redeem sub-form */
    .redeem-row{display:flex;gap:8px;margin-top:8px}
    .redeem-row input{flex:1;padding:10px 12px;border:1px solid #e1e5e1;border-radius:10px}
    .redeem-row button{border:0;background:var(--green);color:#fff;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
    .redeem-row button:hover{background:var(--accent)}
    .muted{color:#6b7280;font-size:13px}

    /* FIX: Added container for clean link spacing in cards */
    .card-actions {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 10px; /* Space below the form/description */
    }
    .card-actions a {
      /* Override generic .card a margin-top */
      margin-top: 0;
    }

  </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar">
  <a href="/" class="brand-logo">
    <video src="/images/Spice-Jar.mp4" autoplay muted loop playsinline></video>
    <span>SpiceJar</span>
  </a>

  <form class="nav-search" role="search" onsubmit="return false;">
    <input id="nav-q" type="search" placeholder="Search spices…" aria-label="Search" th:value="${q}">
    <button id="nav-search-btn" type="button" aria-label="Search">
      <i class="fa-solid fa-magnifying-glass"></i>
    </button>
  </form>

  <div class="nav-links">
    <a th:href="@{/menu}">Menu</a>
    <a th:href="@{/about}">About Us</a>
    <a class="nav-link" th:href="@{/cart/view}">
      <div class="cart-icon-container" aria-live="polite" aria-label="Cart items">
        <i class="fas fa-shopping-cart" style="font-size:24px"></i>
        <span class="cart-count-badge" id="lblCartCount" th:text="${cartCount}">0</span>
      </div>
    </a>
    <a th:href="@{/contact}">Contact Us</a>

    <!-- Account -->
    <div class="dropdown">
      <button class="dropdown-toggle">
        <i class="fas fa-user"></i>
        <span th:text="${session.USER != null ? session.USER.firstName : 'Account'}">Account</span>
      </button>
      <div class="dropdown-menu">
        <a th:if="${session.USER == null}" th:href="@{/login}">Login</a>
        <a th:if="${session.USER == null}" th:href="@{/register}">Register</a>

        <span th:if="${session.USER != null}">
          Welcome, <strong th:text="${session.USER.firstName}">User</strong>
        </span>
        <a th:if="${session.USER != null}" th:href="@{/account}">Your Account</a>
        <a th:if="${session.USER != null}" th:href="@{/orders}">My Orders</a>
        <a th:if="${session.USER != null}" th:href="@{/logout}">Logout</a>
      </div>
    </div>
  </div>
</nav>

<div class="wrap">
  <h1>Your Account</h1>

  <div class="grid">
    <!-- Orders -->
    <div class="card">
      <i class="fa-solid fa-box"></i>
      <div>
        <h3>Your Orders <span class="badge" th:text="${orderCount}">0</span></h3>
        <p>Track, return, cancel an order, download invoice or buy again.</p>
        <a th:href="@{/orders}">Go to Your Orders</a>
      </div>
    </div>

    <!-- Profile / Security -->
    <div class="card">
      <i class="fa-solid fa-user-shield"></i>
      <div>
        <h3>Login &amp; security</h3>
        <p>Edit login, name, phone and email. Update your password.</p>
        <a th:href="@{/profile/view}">View profile</a>
        <a th:href="@{/profile}">Edit profile</a>
      </div>
    </div>

    <!-- Addresses -->
    <div class="card">
      <i class="fa-solid fa-location-dot"></i>
      <div>
        <h3>Your Addresses <span class="badge" th:text="${addressCount}">0</span></h3>
        <p>Edit, remove or set default address.</p>
        <a th:href="@{/addresses}">Manage addresses</a>
      </div>
    </div>

    <!-- Gift Cards -->
    <div class="card">
      <i class="fa-solid fa-gift"></i>
      <div style="flex:1">
        <h3>Gift Cards</h3>
        <p>Redeem a code or manage your gift card balance.</p>
<!--        <form th:action="@{/gift-cards/redeem}" method="post" class="redeem-row" th:if="${session.USER != null}">-->
<!--          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
<!--          <input type="text" name="code" placeholder="Enter gift card code (e.g., SJ-9K4T-AX7L)" required minlength="8" maxlength="32" autocomplete="off"/>-->
<!--          <button type="submit"><i class="fa-solid fa-check"></i> Redeem</button>-->
<!--        </form>-->
<!--        <div class="muted" th:if="${session.USER == null}">Login to redeem a gift card.</div>-->

        <div class="card-actions">
          <a th:href="@{/gift-cards}"><i class="fa-solid fa-wallet"></i> Manage gift cards</a>
          <a th:href="@{/gift-cards/buy}"><i class="fa-solid fa-cart-shopping"></i> Buy a gift card</a>
        </div>
      </div>
    </div>

    <!-- Returns & refunds quick-link -->
    <div class="card">
      <i class="fa-solid fa-arrow-rotate-left"></i>
      <div>
        <h3>Returns &amp; Refunds</h3>
        <p>Start a return and check refund status.</p>
        <a th:href="@{/orders}">Start a return</a>
      </div>
    </div>

    <!-- Help / Support -->
    <div class="card">
      <i class="fa-regular fa-life-ring"></i>
      <div>
        <h3>Support</h3>
        <p>Troubleshoot issues or contact us.</p>
        <a th:href="@{/contact}">Get help</a>
      </div>
    </div>
  </div>
</div>


  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-container">
      <div class="footer-column">
        <h3>About Spice Jar</h3>
        <p>Bringing the world's finest spices to your kitchen. Quality, aroma, and flavor guaranteed in every jar.</p>
      </div>
      <div class="footer-column">
        <h3>Quick Links</h3>
        <ul>
          <li><a th:href="@{/menu}">Menu</a></li>
          <li><a th:href="@{/about}">About Us</a></li>
          <li><a th:href="@{/contact}">Contact</a></li>
          <li><a href="#">FAQ</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h3>Connect With Us</h3>
        <div class="social-links">
          <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
          <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="#" aria-label="Pinterest"><i class="fab fa-pinterest"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom"><p>&copy; 2025 The Spice Jar. All rights reserved.</p></div>
  </footer>
</body>
</html>