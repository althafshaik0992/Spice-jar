<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Your Account • The Spice Jar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    :root{--green:#218838;--accent:#b7410e;--bg:#f6fbf6;--card:#fff;--muted:#6b7280}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;background:var(--bg);color:#111}
    .navbar{background:#fff;padding:10px 6%;box-shadow:0 2px 6px rgba(0,0,0,.06);display:flex;justify-content:space-between;align-items:center}
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--green);font-weight:800}
    .brand video{width:36px;border-radius:6px}
    .nav a{color:#333;text-decoration:none;margin-left:16px;font-weight:600}
    .nav a:hover{color:var(--green)}
    .wrap{max-width:1100px;margin:26px auto;padding:0 6%}
    h1{font-size:28px;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(260px,1fr));gap:16px}
    @media (max-width:980px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.06);padding:16px;display:flex;gap:14px;align-items:flex-start}
    .card i, .card .icon{font-size:28px;color:var(--green)}
    .card h3{margin:0 0 4px;font-size:18px}
    .card p{margin:0;color:#475569}
    .card a{display:block;margin-top:8px;color:var(--green);font-weight:700;text-decoration:none}
    .badge{display:inline-block;background:#eef6ff;border:1px solid #dbeafe;border-radius:999px;padding:2px 8px;font-size:12px;color:#0f172a;margin-left:6px}
    .footer{color:#777;text-align:center;margin:28px 0}
    /* Navbar */
    .navbar{
      background:#fff; padding:6px 6%;
      box-shadow:0 2px 6px rgba(0,0,0,.05);
      display:flex; justify-content:space-between; align-items:center;
      position:sticky; top:0; z-index:1000; height:60px;
    }
    .brand-logo{display:flex; align-items:center; gap:8px; text-decoration:none; color:var(--green); font-weight:700; font-size:20px}
    .brand-logo video{width:36px; height:auto; border-radius:4px}
    .nav-links{display:flex; align-items:center; gap:18px}
    .nav-links a{text-decoration:none; color:#333; font-weight:500; font-size:15px}
    .nav-links a:hover{color:var(--green)}

    /* Dropdowns */
    .dropdown{position:relative}
    .dropdown-toggle{
      background:none; border:none; cursor:pointer; font-size:15px; color:#333;
      display:flex; align-items:center; gap:6px
    }
    .dropdown-menu{
      display:none; position:absolute; right:0; top:100%;
      background:#fff; box-shadow:0 4px 10px rgba(0,0,0,.1);
      border-radius:6px; overflow:hidden; min-width:180px
    }
    .dropdown:hover .dropdown-menu{display:block}
    .dropdown-menu a, .dropdown-menu span{
      display:block; padding:10px 16px; text-decoration:none; color:#333; white-space:nowrap
    }
    .dropdown-menu a:hover{background:#f4f4f4}
    /* Cart count badge style */
    .cart-icon-container {
      position: relative;
      display: inline-block;
    }
    .cart-count-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: var(--accent);
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 12px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 20px;
      height: 20px;
      text-align: center;
    }

    .dropdown{position:relative}
    .dropdown-toggle{
      display:flex; align-items:center; gap:8px; background:transparent; border:0; cursor:pointer;
      font-weight:700; color:#2b2b2b; padding:8px 10px; border-radius:10px;
    }
    .dropdown-toggle:hover{background:#f5f7f5}
    .dropdown-menu{
      position:absolute; right:0; top:calc(100% + 8px); min-width:200px;
      background:#fff; border:1px solid #eef2ef; border-radius:12px; box-shadow:0 10px 28px var(--ring);
      display:none; overflow:hidden;
    }
    .dropdown:hover .dropdown-menu{display:block}
    .dropdown-menu a, .dropdown-menu span{
      display:block; padding:10px 14px; text-decoration:none; color:#2b2b2b; font-weight:600;
      white-space:nowrap
    }
    .dropdown-menu a:hover{background:#f7faf7}
    .divider{height:1px; background:#eef2ef; margin:6px 0}
  </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar">
  <a href="/" class="brand-logo">
    <video src="/images/Spice-Jar.mp4" autoplay muted loop playsinline></video>
    <span>SpiceJar</span>
  </a>

  <div class="nav-links">
    <a th:href="@{/menu}">Menu</a>
    <a th:href="@{/about}">About Us</a>
    <a class="nav-link" th:href="@{/cart/view}">
      <div class="cart-icon-container" aria-live="polite" aria-label="Cart items">
        <i class="fas fa-shopping-cart" style="font-size:24px"></i>
        <span class="cart-count-badge" id="lblCartCount" th:text="${cartCount}">0</span>
      </div>
    </a>
    <a th:href="@{/contact}">Contact Us</a>

    <!-- Categories -->
    <div class="dropdown">
      <button class="dropdown-toggle">
        <i class="fa-solid fa-list"></i> Categories
      </button>
      <div class="dropdown-menu">
        <a th:each="c : ${categories}"
           th:href="@{/category/{id}(id=${c.id})}"
           th:text="${c.name}">Category</a>
      </div>
    </div>

    <!-- Account -->
      <div class="dropdown">
        <button class="dropdown-toggle">
          <i class="fas fa-user"></i>
          <span th:text="${session.USER != null ? session.USER.firstName : 'Account'}">Account</span>
        </button>
        <div class="dropdown-menu">
          <a th:if="${session.USER == null}" th:href="@{/login}">Login</a>
          <a th:if="${session.USER == null}" th:href="@{/register}">Register</a>

          <span th:if="${session.USER != null}">
          Welcome, <strong th:text="${session.USER.firstName}">User</strong>
        </span>
          <a th:if="${session.USER != null}" th:href="@{/account}">Your Account</a>
          <a th:if="${session.USER != null}" th:href="@{/orders}">My Orders</a>
          <a th:if="${session.USER != null}" th:href="@{/logout}">Logout</a>
        </div>
      </div>
    </div>
  </div>
</nav>


<div class="wrap">
  <h1>Your Account</h1>

  <div class="grid">
    <!-- Orders -->
    <div class="card">
      <i class="fa-solid fa-box"></i>
      <div>
        <h3>Your Orders <span class="badge" th:text="${orderCount}">0</span></h3>
        <p>Track, return, cancel an order, download invoice or buy again.</p>
        <a th:href="@{/orders}">Go to Your Orders</a>
      </div>
    </div>

    <!-- Profile / Security -->
    <div class="card">
      <i class="fa-solid fa-user-shield"></i>
      <div>
        <h3>Login &amp; security</h3>
        <p>Edit login, name, phone and email. Update your password.</p>
        <a th:href="@{/profile/view}">View profile</a>
        <a th:href="@{/profile}">Edit profile</a>
      </div>
    </div>

    <!-- Addresses -->
    <div class="card">
      <i class="fa-solid fa-location-dot"></i>
      <div>
        <h3>Your Addresses <span class="badge" th:text="${addressCount}">0</span></h3>
        <p>Edit, remove or set default address.</p>
        <a th:href="@{/addresses}">Manage addresses</a>
      </div>
    </div>

<!--    <div class="card">-->
<!--      <i class="fa-solid"></i>-->
<!--    <div>-->
<!--      <h3> Send welcome email</h3>-->
<!--      <p>Send welcome email to the email address provided .</p>-->
<!--      <form th:action="@{/account/welcome-email}"  method="post" class="quantity-form" style="display:inline-flex; align-items:center; gap: 10px;">-->
<!--        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
<!--        <button type="submit" class="quantity-submit">Send Email</button>-->
<!--      </form>-->
<!--    </div>-->
<!--    </div>-->
<!--    <form th:action="@{/account/welcome-email}" method="post" style="display:inline">-->
<!--      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
<!--      <button class="btn" type="submit"><i class="fa-solid fa-envelope"></i> Send welcome email</button>-->
<!--    </form>-->


    <!-- Returns & refunds quick-link -->
    <div class="card">
      <i class="fa-solid fa-arrow-rotate-left"></i>
      <div>
        <h3>Returns &amp; Refunds</h3>
        <p>Start a return and check refund status.</p>
        <a th:href="@{/orders}">Start a return</a>
      </div>
    </div>

    <!-- Help / Support -->
    <div class="card">
      <i class="fa-regular fa-life-ring"></i>
      <div>
        <h3>Support</h3>
        <p>Troubleshoot issues or contact us.</p>
        <a th:href="@{/contact}">Get help</a>
      </div>
    </div>
  </div>

  <div class="footer">© <span th:text="${year}">2025</span> The Spice Jar</div>
</div>
</body>
</html>
