<!-- src/main/resources/templates/addresses.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>My Addresses â€¢ The Spice Jar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <style>
        :root{--green:#218838;--accent:#b7410e;--bg:#f6fbf6}
        body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;background:var(--bg)}
        .wrap{max-width:960px;margin:24px auto;padding:0 6%}
        .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
        .card{background:#fff;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.06);padding:16px}
        .badge{display:inline-block;background:#e8f5e9;color:#167c2f;font-weight:700;border-radius:14px;padding:2px 8px;margin-left:8px}
        .btn{display:inline-flex;align-items:center;gap:6px;border:none;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer;text-decoration:none}
        .btn-primary{background:var(--green);color:#fff}
        .btn-ghost{background:#f3f4f6}
        .row{display:flex;gap:10px;flex-wrap:wrap}
        /* Navbar */
        .navbar{
            background:#fff; padding:6px 6%;
            box-shadow:0 2px 6px rgba(0,0,0,.05);
            display:flex; justify-content:space-between; align-items:center;
            position:sticky; top:0; z-index:1000; height:60px;
        }
        .brand-logo{display:flex; align-items:center; gap:8px; text-decoration:none; color:var(--green); font-weight:700; font-size:20px}
        .brand-logo video{width:36px; height:auto; border-radius:4px}
        .nav-links{display:flex; align-items:center; gap:18px}
        .nav-links a{text-decoration:none; color:#333; font-weight:500; font-size:15px}
        .nav-links a:hover{color:var(--green)}

        /* Dropdowns */
        .dropdown{position:relative}
        .dropdown-toggle{
            background:none; border:none; cursor:pointer; font-size:15px; color:#333;
            display:flex; align-items:center; gap:6px
        }
        .dropdown-menu{
            display:none; position:absolute; right:0; top:100%;
            background:#fff; box-shadow:0 4px 10px rgba(0,0,0,.1);
            border-radius:6px; overflow:hidden; min-width:180px
        }
        .dropdown:hover .dropdown-menu{display:block}
        .dropdown-menu a, .dropdown-menu span{
            display:block; padding:10px 16px; text-decoration:none; color:#333; white-space:nowrap
        }
        .dropdown-menu a:hover{background:#f4f4f4}
        /* Cart count badge style */
        .cart-icon-container {
            position: relative;
            display: inline-block;
        }
        .cart-count-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--accent);
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 20px;
            height: 20px;
            text-align: center;
        }

        .dropdown{position:relative}
        .dropdown-toggle{
            display:flex; align-items:center; gap:8px; background:transparent; border:0; cursor:pointer;
            font-weight:700; color:#2b2b2b; padding:8px 10px; border-radius:10px;
        }
        .dropdown-toggle:hover{background:#f5f7f5}
        .dropdown-menu{
            position:absolute; right:0; top:calc(100% + 8px); min-width:200px;
            background:#fff; border:1px solid #eef2ef; border-radius:12px; box-shadow:0 10px 28px var(--ring);
            display:none; overflow:hidden;
        }
        .dropdown:hover .dropdown-menu{display:block}
        .dropdown-menu a, .dropdown-menu span{
            display:block; padding:10px 14px; text-decoration:none; color:#2b2b2b; font-weight:600;
            white-space:nowrap
        }
        .dropdown-menu a:hover{background:#f7faf7}
        .divider{height:1px; background:#eef2ef; margin:6px 0}
    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar">
    <a href="/" class="brand-logo">
        <video src="/images/Spice-Jar.mp4" autoplay muted loop playsinline></video>
        <span>SpiceJar</span>
    </a>

    <div class="nav-links">
        <a th:href="@{/menu}">Menu</a>
        <a th:href="@{/about}">About Us</a>
        <a class="nav-link" th:href="@{/cart/view}">
            <div class="cart-icon-container" aria-live="polite" aria-label="Cart items">
                <i class="fas fa-shopping-cart" style="font-size:24px"></i>
                <span class="cart-count-badge" id="lblCartCount" th:text="${cartCount}">0</span>
            </div>
        </a>
        <a th:href="@{/contact}">Contact Us</a>

        <!-- Categories -->
        <div class="dropdown">
            <button class="dropdown-toggle">
                <i class="fa-solid fa-list"></i> Categories
            </button>
            <div class="dropdown-menu">
                <a th:each="c : ${categories}"
                   th:href="@{/category/{id}(id=${c.id})}"
                   th:text="${c.name}">Category</a>
            </div>
        </div>

        <!-- Account -->
        <div class="dropdown">
            <button class="dropdown-toggle">
                <i class="fas fa-user"></i>
                <span th:text="${session.USER != null ? session.USER.firstName : 'Account'}">Account</span>
            </button>
            <div class="dropdown-menu">
                <a th:if="${session.USER == null}" th:href="@{/login}">Login</a>
                <a th:if="${session.USER == null}" th:href="@{/register}">Register</a>

                <span th:if="${session.USER != null}">
          Welcome, <strong th:text="${session.USER.firstName}">User</strong>
        </span>
                <a th:if="${session.USER != null}" th:href="@{/account}">Your Account</a>
                <a th:if="${session.USER != null}" th:href="@{/orders}">My Orders</a>
                <a th:if="${session.USER != null}" th:href="@{/logout}">Logout</a>
            </div>
        </div>
    </div>
</nav>

<!-- Navbar reused from profile (copy your block) -->

<div class="wrap">
    <h2><i class="fa-solid fa-location-dot"></i> My Addresses</h2>

    <div class="row" style="margin:12px 0">
        <a class="btn btn-primary" th:href="@{/addresses/new}">
            <i class="fa-solid fa-plus"></i> Add new address
        </a>
    </div>

    <div class="grid">
        <div class="card" th:each="a : ${addresses}">
            <div style="font-weight:800">
                <span th:text="${a.fullName}">Name</span>
                <span class="badge" th:if="${a.defaultAddress}">Default</span>
            </div>
            <div th:text="${a.phone}" style="color:#666;margin:6px 0">555-...</div>
            <div th:text="${a.line1}">line1</div>
            <div th:if="${a.line2}" th:text="${a.line2}">line2</div>
            <div>
                <span th:text="${a.city}">City</span>,
                <span th:text="${a.state}">State</span>
                <span th:text="${a.zip}">Zip</span>
            </div>
            <div th:text="${a.country}">Country</div>

            <div class="row" style="margin-top:12px">
                <a class="btn btn-ghost" th:href="@{/addresses/{id}/edit(id=${a.id})}">
                    <i class="fa-solid fa-pen"></i> Edit
                </a>
                <form th:action="@{/addresses/{id}/default(id=${a.id})}" method="post">
                    <button class="btn btn-ghost" type="submit" th:disabled="${a.defaultAddress}">
                        <i class="fa-solid fa-star"></i> Make default
                    </button>
                </form>
                <form th:action="@{/addresses/{id}/delete(id=${a.id})}" method="post"
                      onsubmit="return confirm('Delete this address?')">
                    <button class="btn btn-ghost" type="submit">
                        <i class="fa-solid fa-trash"></i> Delete
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Footer reused from profile -->

</body>
</html>
